#!/bin/bash

if [ $# -lt 1 ];then
	echo usage  : $0 servername [command...]
    echo example: $0 remote-name username@ssh remote-name
	exit 1
fi

ping="$1"
which sshrm
if [ $? -eq 0 ]; then
	sshrm "$ping"
fi
shift
st=1
while [ $st -ne 0 ]; do
	ping -c 1 $ping 2>&1 > /dev/null
	st=$?
	if [ $st -ne 0 ]; then
		echo $ping is DEAD
		sleep 1	
	else
		ping -c 1 $ping | egrep -e bytes # -e loss
		if [ $# -gt 0 ];then
			echo $ `eval "$@"`
			eval "$@"
		fi
	fi
done

# That's all Folks!
##
